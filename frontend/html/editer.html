<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title>폼 제작 - Form Builder</title>

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
        <link rel="stylesheet" href="../css/header.css" />
        <link rel="stylesheet" href="../css/editer.css" />
        <link rel="stylesheet" href="../css/response.css" />
        <link rel="stylesheet" href="../css/settings.css" />
    </head>

    <body>
        <div>
            <nav class="navbar navbar-light bg-white px-2">
                <a class="navbar-brand d-flex align-items-center" href="/frontend/html/">
                    <i class="bi bi-ui-checks-grid fs-4"></i>
                </a>

                <div class="d-flex align-items-center">
                    <div class="dropdown">
                        <button class="icon-btn" data-bs-toggle="dropdown" data-tooltip="테마 설정">
                            <i class="bi bi-palette"></i>
                        </button>

                        <div class="dropdown-menu p-3 theme-menu">
                            <div class="small fw-medium mb-1">색상</div>
                            <div class="color-row">
                                <div class="theme-color" data-color="#db4437" style="background: #db4437"></div>
                                <div class="theme-color" data-color="#673ab7" style="background: #673ab7"></div>
                                <div class="theme-color" data-color="#3f51b5" style="background: #3f51b5"></div>
                                <div class="theme-color" data-color="#4285f4" style="background: #4285f4"></div>
                                <div class="theme-color" data-color="#03a9f4" style="background: #03a9f4"></div>
                                <div class="theme-color" data-color="#00bcd4" style="background: #00bcd4"></div>

                                <div class="theme-color" data-color="#ff5722" style="background: #ff5722"></div>
                                <div class="theme-color" data-color="#ff9800" style="background: #ff9800"></div>
                                <div class="theme-color" data-color="#009688" style="background: #009688"></div>
                                <div class="theme-color" data-color="#4caf50" style="background: #4caf50"></div>
                                <div class="theme-color" data-color="#607d8b" style="background: #607d8b"></div>
                                <div class="theme-color" data-color="#9e9e9e" style="background: #9e9e9e"></div>
                            </div>

                            <div class="bg-row mt-3">
                                <div class="bg-label small fw-medium">배경</div>
                                <div class="background-group"></div>
                            </div>
                        </div>
                    </div>

                    <button class="icon-btn" id="previewHeaderBtn" data-tooltip="미리보기">
                        <i class="bi bi-eye"></i>
                    </button>

                    <button class="icon-btn" id="undoBtn" data-tooltip="되돌리기">
                        <i class="bi bi-arrow-counterclockwise"></i>
                    </button>

                    <button class="icon-btn" id="redoBtn" data-tooltip="다시 실행">
                        <i class="bi bi-arrow-clockwise"></i>
                    </button>

                    <div class="dropdown">
                        <button class="icon-btn" data-bs-toggle="dropdown" data-tooltip="공유">
                            <i class="bi bi-share"></i>
                        </button>

                        <div class="dropdown-menu p-3 share-menu small">
                            <div class="fw-semibold mb-2">응답자 링크</div>
                            <input type="text" class="form-control form-control-sm mb-1" id="originalUrl" readonly />
                            <input type="text" class="form-control form-control-sm mb-2" id="shortUrl" readonly />
                            <button class="btn btn-secondary btn-sm w-100" id="copyUrlBtn">복사</button>
                        </div>
                    </div>

                    <div class="dropdown">
                        <button class="icon-btn" data-bs-toggle="dropdown" data-tooltip="게시">
                            <i class="bi bi-upload"></i>
                        </button>

                        <div class="dropdown-menu small">
                            <button class="dropdown-item" id="manageFormBtn">관리</button>
                            <button class="dropdown-item" id="shareFormBtn">공유</button>
                        </div>
                    </div>

                    <div class="dropdown">
                        <button class="icon-btn" data-bs-toggle="dropdown" data-tooltip="더보기">
                            <i class="bi bi-three-dots"></i>
                        </button>

                        <div class="dropdown-menu small">
                            <button class="dropdown-item text-danger" id="moveToTrashBtn">휴지통으로 이동</button>
                            <button class="dropdown-item" id="unpublishBtn">게시 취소</button>
                        </div>
                    </div>
                </div>
            </nav>

            <header class="global-header bg-white border-bottom px-3">
                <nav class="page-tabs">
                    <button class="tab-btn active fw-semibold" data-page="questions">질문</button>
                    <button class="tab-btn fw-semibold" data-page="responses">응답</button>
                    <button class="tab-btn fw-semibold" data-page="settings">설정</button>
                    <div class="tab-underline"></div>
                </nav>
            </header>
        </div>

        <div class="builder-wrapper container">
            <div id="questionsPage" class="questions-page">
                <main class="builder-container">
                    <section id="blocksContainer" class="blocks-container d-flex flex-column gap-3 mb-4">
                        <div class="card block-card title-block-card" data-block-type="title">
                            <div class="card-body">
                                <div class="editor-wrapper mb-2">
                                    <div id="formTitleInput" class="form-title-editable form-input-base" contenteditable="true" data-placeholder="제목 없는 설문지"></div>
                                    <div class="editor-toolbar mb-1">
                                        <button class="toolbar-btn" data-cmd="bold"><i class="bi bi-type-bold"></i></button>
                                        <button class="toolbar-btn" data-cmd="italic"><i class="bi bi-type-italic"></i></button>
                                        <button class="toolbar-btn" data-cmd="underline"><i class="bi bi-type-underline"></i></button>
                                        <button class="toolbar-btn" data-cmd="removeFormat"><i class="bi bi-x-circle"></i></button>
                                    </div>
                                </div>

                                <div class="editor-wrapper">
                                    <div id="formDescriptionInput" class="form-description-editable form-input-base" contenteditable="true" data-placeholder="설문지 설명을 입력하세요"></div>
                                    <div class="editor-toolbar mb-1">
                                        <button class="toolbar-btn" data-cmd="bold"><i class="bi bi-type-bold"></i></button>
                                        <button class="toolbar-btn" data-cmd="italic"><i class="bi bi-type-italic"></i></button>
                                        <button class="toolbar-btn" data-cmd="underline"><i class="bi bi-type-underline"></i></button>
                                        <button class="toolbar-btn" data-cmd="insertOrderedList"><i class="bi bi-list-ol"></i></button>
                                        <button class="toolbar-btn" data-cmd="insertUnorderedList"><i class="bi bi-list-ul"></i></button>
                                        <button class="toolbar-btn" data-cmd="removeFormat"><i class="bi bi-x-circle"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section class="text-center mt-2 d-md-none">
                        <button id="addQuestionBtn" class="btn btn-outline-primary"><i class="bi bi-plus-lg me-1"></i> 질문 추가</button>
                    </section>

                    <section class="mt-4">
                        <details>
                            <summary class="small text-muted mb-1" style="cursor: pointer">현재 폼 구조(JSON) 보기</summary>
                            <pre id="debugOutput" class="bg-dark text-light p-3 rounded small mt-2" style="max-height: 260px; overflow: auto"></pre>
                        </details>
                    </section>

                    <aside class="floating-menu d-none bg-white d-md-flex flex-column">
                        <button class="floating-btn" id="sideAddQuestionBtn" aria-label="질문 추가" data-tooltip="질문 추가">
                            <i class="floating-icon bi bi-plus-lg"></i>
                        </button>

                        <button class="floating-btn" id="sideAddSectionBtn" aria-label="섹션 추가" data-tooltip="섹션 추가">
                            <i class="floating-icon bi bi-layout-three-columns"></i>
                        </button>
                    </aside>
                </main>
            </div>

            <div id="responsesPage" class="responses-page"></div>

            <div id="settingsPage" class="settings-page">
                <div class="settings-root">
                    <div class="setting-section" style="padding-top: 6px">
                        <div class="section-header" data-toggle="section">
                            <div class="title-box">
                                <div class="main-title">응답</div>
                                <div class="sub-title">응답 수집 및 보호 방식을 관리합니다.</div>
                            </div>
                            <button class="section-toggle-btn">
                                <i class="bi bi-chevron-down"></i>
                            </button>
                        </div>

                        <div class="section-body">
                            <div class="setting-item" style="padding-bottom: 20px">
                                <div>
                                    <label>응답 수정 허용</label>
                                    <div class="sub-title">제출 후에 응답을 수정할 수 있습니다.</div>
                                </div>
                                <div>
                                    <input type="checkbox" class="setting-toggle" id="modifyResponse" />
                                </div>
                            </div>

                            <div class="sub-title">로그인 필요</div>
                            <div class="setting-item">
                                <label>응답 횟수 1회로 제한</label>
                                <div>
                                    <input type="checkbox" class="setting-toggle" id="limitOneResponse" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-section">
                        <div class="section-header" data-toggle="section">
                            <div class="title-box">
                                <div class="main-title">프레젠테이션</div>
                                <div class="sub-title">양식 및 응답 표시 방식을 관리합니다.</div>
                            </div>
                            <button class="section-toggle-btn">
                                <i class="bi bi-chevron-down"></i>
                            </button>
                        </div>

                        <div class="section-body">
                            <div class="sub-title">제출 후</div>
                            <div class="setting-item column setting-submit">
                                <label>확인 메시지</label>
                                <input id="submitMessage" class="submit-message form-control" rows="2" placeholder="응답이 기록되었습니다." />
                            </div>

                            <div class="setting-item" style="padding: 0">
                                <label>다른 응답 제출 링크 표시</label>
                                <div>
                                    <input type="checkbox" class="setting-toggle" id="showAnotherLink" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-section border-0" style="padding-bottom: 6px">
                        <div class="section-header" data-toggle="section">
                            <div class="title-box">
                                <div class="main-title">질문 기본값</div>
                                <div class="sub-title">설정이 모든 새 질문에 적용됩니다.</div>
                            </div>
                            <button class="section-toggle-btn">
                                <i class="bi bi-chevron-down"></i>
                            </button>
                        </div>

                        <div class="section-body">
                            <div class="setting-item">
                                <label>기본적으로 필수 질문으로 지정</label>
                                <div>
                                    <input type="checkbox" class="setting-toggle" id="defaultRequired" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
        <script src="../js/api.js" defer></script>
        <script src="../js/header.js" defer></script>
        <script src="../js/editer.js" defer></script>
        <script src="../js/response.js" defer></script>
        <script src="../js/settings.js" defer></script>
    </body>
</html>
